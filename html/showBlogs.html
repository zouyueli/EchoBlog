<html>
	<head>
		<meta charset="utf-8">
		<title>博客总览</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
	</head>
	<body>
		<div id="show-blogs">
		  <h1>博客总览</h1>
		  <input type="text" placeholder="搜索" />
		  <div class="wrapper">
		  	
		  </div>
		  
		  <!-- <div class="single-blog" value="">
			  <a>
				  <h2>title</h2>
			  </a>
			  <div> content</div>
		  </div> -->
		</div>
		
		<script src="../js/jquery.min.js"></script>
		<script type="text/javascript">
			$(document).ready(function(){
				let wrapper = $(".wrapper");
				
				let p1 = new Promise((resolve,reject)=>{
					$.ajax({
						method:"get",
						url:"http://127.0.0.1:8080/showBlogs",
						success:function(data){
							resolve(data);
						},
						error:function(err){
							reject(err);
						}
					});
				})
				
				p1.then(function(data){
					let obj = JSON.parse(data);
					$.addNodes(obj);
					$(".wrapper").click(function(e){
						let event = e || window.event;
						let target = event.target || event.srcElement;
						let id =$(target).attr("value");
						console.log(id)
						window.location.href = "./singleBlog.html?id="+id;
					})
				}).catch(function(err){
					console.log(err);
				});
				
				
				$.addNodes = function(data){
					for(let i= data.length-1; i>=0; i--){
						let a = $("<a>").append($("<h2>").attr("value",data[i]["id"]).text(data[i]["title"]));
						let article = $("<article>").text(data[i]["content"]);
						let div = $("<div>").addClass("single-blog").append(a,article);
						$(".wrapper").append(div);
					}
				}
			})
		</script>
		
	</body>
</html>

<style scoped>
#show-blogs {
  max-width: 800px;
  margin: 0 auto;
}

.single-blog {
  padding: 20px;
  margin: 20px 0;
  box-sizing: border-box;
  background: #eee;
  border: 1px dotted #aaa;
}

#show-blogs a {
  color: #444;
  text-decoration: none;
}
input[type="text"] {
  padding: 8px;
  width: 100%;
  box-sizing: border-box;
}

.single-blog a h2:hover{
	color:orange;
	cursor: pointer;
}
</style>
